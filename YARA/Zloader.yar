/*
  Zloader detection - this file is free for commercial use and basis for product detection
*/

import "vt"

rule ZloaderXLS
{
  strings:
    $0 = {B9202CEDF8B56B55DFC369C04292461DFFC168F0C975DF1312A521A22CC51D7F8E857F73F7E38F6EA01D19E3047B609F8A1DD4F16329B39D4A4504308CC43596E114EE4D184F90844B1E55428E4EC06F422B5BD56AB3922092FA5E8A12707B77322101F646CAA5BFBB70DEA770994AA10602CA87CA35B62C34369CD61442CC459772EF18D18E0FF384EC64849F48DFA34848B8D1F1ABFACFAFECDEA8A09DC288CA0DB686DD40FF1576854138DDD273F2685C4E5AAF}
    $1 = {457863656C20342E30204D6163726F73}
  condition:
    vt.metadata.new_file and
    all of them
}

rule ZloaderXLS-Behavior
{
  strings:
    $0 = {992416C9D8B2A755FBF74CD25442A820166C2CD933F79E3BE372BD1F07B5C3989CA74AAFF2422B24EB1B475DA5DF374FD9AD5689811A183C61A50F98F4BABEBC2837878049899A52A57BE670674CB23D8E90721F90A4D2FA3802CB35762680FD800ECD7551DC18EB899138E3C943D7E503B6B01D583DEEE5F99824E290B4BA3F364EAC4A430883B3C092D4ECA8F946C916422ECAB927F52EA42B89A1CD59C254F919B0E85E6535D135A8DE20F20B8C12C3B00C895FCF6720192DE6BF3B9E89ECDBD6596CBCDD8EB28E7C365ECC4EC1FF1460F53FE813}
    $1 = {457863656C20342E30204D6163726F73}
  condition:
    vt.metadata.new_file and
    all of them
}

rule ZloaderDLL
{
  strings:
    $0 = {C69CB5F9A703F54F601B4FDDA36E5AD1279DFE0EFD19444FE10498F2601BAD0C691BF4D04AC15E5060A4EE813B9DE29FAA1BF4D82E9FDA53D534AFED291CF4D85B82F52956F65F2263DCBE58C69CBB0380A4CB80705BD6254961F94F6021FA55669F8BEDFD271A2A3B9B75CEDFB0165D6CAB64B4C087F55364556D1B4AE9C41F27A389D1E019E04F4BB38BEBFE794CA9B847277394C0B9D1E51EAF4F5B8355B1C1DB4A99AE9E62D71FF412C6D6CFB9CAAEAE1DCCA9305AA9B7B03D75F1411B4B9DBD192B1EA3656853}
    $1 = {C14B43BBDDE31693D6DCAC579F200F546C2006EE1BB74204B9800B667C7F5EDD31E467DB1B6D17929A0D6B8376733682F28C448CA3010FE39146B3E3D9D42F639F81699C634C65E60A837C10F4C028DD5865D0962EF2D350BC3BB0887460887D7CB4C7C925A840B5E51678147CE0F0F0A7A4C82C46E91C99DC6B1CD31DCF894E5EE1E1D816D97020289615F90CFDF72369BB4EC5F5C28860958E8E}
  condition:
    vt.metadata.new_file and
    all of them
}

rule ZloaderDLLNew
{
  strings:
    $0 = {9CB5F9A703F54F601B4FDDA36E5AD1279DFE0EFD19444FE10498F2601BAD0C691BF4D04AC15E5060A4EE813B9DE29FAA1BF4D82E9FDA53D534AFED291CF4D85B82F52956F65F2263DCBE58C69CBB0380A4CB80705BD6254961F94F6021FA55669F8BEDFD271A2A3B9B75CEDFB0165D6CAB64B4C087F55364556D1B4AE9C41F27A389D1E019E04F4BB38BEBFE794CA9B847277394C0B9D1E51EAF4F5B8355B1C1DB4A99AE9E62D71FF412C6D6CFB9CAAEAE1DCCA9305AA9B7B03D75F1411B4B9DBD192B1EA365685336C7A984D634A3B3F05022B654EECD9876B103605B3BE7524FA0CECEF8F5BC3B9F76D46CE370378DDFE84454CD56F94528C3DB6CCF2234F546371A9C640A61094F3793A3D5F39B9B77F88D926E8D10E8DF0BC3AEA4CE5929DDD584462EEEB92E6A19B2428310C0BFBC}
  condition:
    vt.metadata.new_file and
    all of them
}
